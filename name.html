<!DOCTYPE html>
<html>
<head>
    <title>Node Monitoring System</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
</head>
<body>

<h2>Node Monitoring Data</h2>

<input type="date" id="date">
<input type="text" id="node" placeholder="Node Number">
<input type="text" id="oms" placeholder="OMS Board Number">
<input type="text" id="gateway" placeholder="Gateway No">
<input type="text" id="scheme" placeholder="Scheme">
<input type="text" id="name" placeholder="Name">
<br><br>

<button onclick="saveData()">Save</button>

<h3>Data Records</h3>
<table border="1" id="dataTable">
<thead>
<tr>
<th>Date</th>
<th>Node</th>
<th>OMS</th>
<th>Gateway</th>
<th>Scheme</th>
<th>Name</th>
</tr>
</thead>
<tbody></tbody>
</table>

<script>

const SUPABASE_URL = "https://jjwlpcsxdgjmqxxlhwxf.supabase.co";
const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Impqd2xwY3N4ZGdqbXF4eGxod3hmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE2NzA1MTEsImV4cCI6MjA4NzI0NjUxMX0.OWqTsDoXJ4DEdSXgLQQuN8Kvo8aUNnhcgSoiqHD5QxY";

const supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

async function saveData() {

    await supabaseClient.from("node_data").insert([{
        date: document.getElementById("date").value,
        node_number: document.getElementById("node").value,
        oms_board_number: document.getElementById("oms").value,
        gateway_no: document.getElementById("gateway").value,
        scheme: document.getElementById("scheme").value,
        name: document.getElementById("name").value
    }]);

    alert("Saved!");
    loadData();
}

async function loadData() {

    const { data } = await supabaseClient
        .from("node_data")
        .select("*");

    const tbody = document.querySelector("#dataTable tbody");
    tbody.innerHTML = "";

    data.forEach(row => {
        tbody.innerHTML += `
        <tr>
            <td>${row.date}</td>
            <td>${row.node_number}</td>
            <td>${row.oms_board_number}</td>
            <td>${row.gateway_no}</td>
            <td>${row.scheme}</td>
            <td>${row.name}</td>
        </tr>`;
    });
}

loadData();

</script>

</body>
</html>